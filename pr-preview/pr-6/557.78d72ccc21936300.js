"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[557],{557:(St,N,r)=>{r.r(N),r.d(N,{AnimeModule:()=>Ct});var u=r(8692),x=r(3178),B=r(2355),Y=r(4373),t=r(4537),Q=r(4762),o=(()=>{return(e=o||(o={})).TV="TV",e.OVA="OVA",e.Movie="MOVIE",e.Special="SPECIAL",e.ONA="ONA",e.Music="MUSIC",e.Unknown="UNKNOWN",o;var e})();!function(e){const n={[e.TV]:"TV",[e.OVA]:"OVA",[e.Movie]:"Movie",[e.Special]:"Special",[e.ONA]:"ONA",[e.Music]:"Music",[e.Unknown]:"Unknown"};e.toReadable=function i(l){return n[l]},e.toAnimeType=function a(l){return n[l]?l:e.Unknown},e.fromReadableToAnimeType=function s(l){for(const c in n)if(l===n[c])return c;return e.Unknown}}(o||(o={}));var f=(()=>{return(e=f||(f={})).Airing="AIRING",e.Finished="FINISHED",e.NotYetAired="NOT_YET_AIRED",e.Unknown="unknown",f;var e})();!function(e){const n={[e.Airing]:"Airing",[e.Finished]:"Finished",[e.NotYetAired]:"Not yet aired",[e.Unknown]:"Unknown"};e.toReadable=function i(s){return n[s]},e.toAnimeStatus=function a(s){return n[s]?s:e.Unknown}}(f||(f={}));var b,C,S,D,P,y=(()=>{return(e=y||(y={})).Id="id",e.TitleEng="title_eng",e.TitleJpn="title_jpn",e.Synopsis="synopsis",e.Status="status",e.Source="source",e.Rating="rating",e.Aired="aired",e.AiredStart="aired__startswith",e.AiredEnd="aired__endswith",e.Created="created",e.Modified="modified",y;var e})(),_=r(4121),v=r(8168),E=r(1588),J=r(1927),Z=r(7969),w=r(5696),z=r(3151),V=r(1528),j=r(9676),U=r(8609),d=r(92),I=r(8635);class G extends I.o{constructor(n){super(),this.items=n.items,this.total=n.total}}(b||(b={})).fromDto=function n({dto:i,resultMapper:a}){return new G({total:i.count,items:i.results.map(s=>a(s))})};class H extends I.o{constructor(n){super(),this.id=n.id,this.image=n.image,this.titleEng=n.titleEng,this.titleJpn=n.titleJpn,this.airedStart=n.airedStart,this.type=n.type,this.status=n.status}}(C||(C={})).fromDto=function n(i){return new H({id:i.id,image:i.image,titleEng:i.title_eng,titleJpn:i.title_jpn,airedStart:null===i.aired.start?null:new Date(i.aired.start),type:o.toAnimeType(i.type),status:i.status})},function(e){e.toDto=function n(i){return{limit:i.limit,offset:i.page*i.limit-i.limit}}}(S||(S={})),function(e){e.filterTypeToDto=function n(i){return`${i.join(",")}`}}(D||(D={})),function(e){e.toDto=function n(i){return""===i.direction?"id":"desc"===i.direction?`-${i.sortBy}`:i.sortBy}}(P||(P={}));var X=r(5893),k=r(5732);let K=(()=>{class e{constructor(i,a){this.httpClient=a,this.animeUrl=new URL("anime/anime/",i.apiUrl)}getPaginatedAnimeList({sortParams:i,paginationParams:a,filterParams:s}){const{offset:l,limit:c}=S.toDto(a);return this.httpClient.get(this.animeUrl.toString(),{params:{[A.offset]:l,[A.limit]:c,[A.order]:P.toDto(i),[A.search]:s.search,[A.typeIn]:D.filterTypeToDto(s.type)}}).pipe((0,Z.U)(T=>b.fromDto({dto:T,resultMapper:C.fromDto})))}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(X._),t.LFG(k.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const A={offset:"offset",limit:"limit",order:"ordering",search:"search",typeIn:"type__in"};var M=r(8659),W=r(8033),q=r(1379),p=r(317),tt=r(2080),et=r(827),L=r(6558),nt=r(9665);function it(e,n){1&e&&t._UZ(0,"mat-progress-bar",2)}function at(e,n){if(1&e&&(t.TgZ(0,"mat-option",9),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.Q6J("value",i.key),t.xp6(1),t.hij(" ",i.value," ")}}function ot(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"mat-paginator",10),t.NdJ("page",function(s){t.CHM(i);const l=t.oxw(2);return t.KtG(l.handlePaginationChange(s))}),t.ALo(1,"async"),t.qZA()}if(2&e){const i=n.ngIf,a=t.oxw().ngIf,s=t.oxw();t.Q6J("length",a.total)("pageSizeOptions",s.pageSizeOptions)("pageSize",t.lcZ(1,4,s.paginationLimit$))("pageIndex",i-1)}}function rt(e,n){1&e&&(t.TgZ(0,"th",23),t._uU(1,"Image"),t.qZA())}function st(e,n){if(1&e&&(t.TgZ(0,"td",24),t._UZ(1,"img",25),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.Q6J("src",i.image,t.LSH)}}function lt(e,n){if(1&e&&(t.TgZ(0,"th",26),t._uU(1," Eng Title "),t.qZA()),2&e){const i=t.oxw(3);t.Q6J("mat-sort-header",i.sortedFields.TitleEng)}}function mt(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.Oqu(i.titleEng)}}function ct(e,n){1&e&&(t.TgZ(0,"th",23),t._uU(1,"Jpn Title"),t.qZA())}function pt(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.Oqu(i.titleJpn)}}function dt(e,n){if(1&e&&(t.TgZ(0,"th",26),t._uU(1," Aired start "),t.qZA()),2&e){const i=t.oxw(3);t.Q6J("mat-sort-header",i.sortedFields.AiredStart)}}function gt(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=n.$implicit,a=t.oxw(3);t.xp6(1),t.hij(" ",t.xi3(2,1,i.airedStart,a.monthYearFormat)||"Not started"," ")}}function ut(e,n){1&e&&(t.TgZ(0,"th",23),t._uU(1,"Type"),t.qZA())}function ft(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const i=n.$implicit,a=t.oxw(3);t.xp6(1),t.hij(" ",a.animeType.toReadable(i.type)," ")}}function ht(e,n){if(1&e&&(t.TgZ(0,"th",26),t._uU(1," Status "),t.qZA()),2&e){const i=t.oxw(3);t.Q6J("mat-sort-header",i.sortedFields.Status)}}function At(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const i=n.$implicit,a=t.oxw(3);t.xp6(1),t.hij(" ",a.animeStatus.toReadable(i.status)," ")}}function Tt(e,n){1&e&&t._UZ(0,"tr",27)}function yt(e,n){1&e&&t._UZ(0,"tr",28)}function _t(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"table",11),t.NdJ("matSortChange",function(s){t.CHM(i);const l=t.oxw(2);return t.KtG(l.handleSortChange(s))}),t.ynx(1,12),t.YNc(2,rt,2,0,"th",13),t.YNc(3,st,2,1,"td",14),t.BQk(),t.ynx(4,15),t.YNc(5,lt,2,1,"th",16),t.YNc(6,mt,2,1,"td",14),t.BQk(),t.ynx(7,17),t.YNc(8,ct,2,0,"th",13),t.YNc(9,pt,2,1,"td",14),t.BQk(),t.ynx(10,18),t.YNc(11,dt,2,1,"th",16),t.YNc(12,gt,3,4,"td",14),t.BQk(),t.ynx(13,19),t.YNc(14,ut,2,0,"th",13),t.YNc(15,ft,2,1,"td",14),t.BQk(),t.ynx(16,20),t.YNc(17,ht,2,1,"th",16),t.YNc(18,At,2,1,"td",14),t.BQk(),t.YNc(19,Tt,1,0,"tr",21),t.YNc(20,yt,1,0,"tr",22),t.qZA()}if(2&e){const i=n.ngIf,a=t.oxw().ngIf,s=t.oxw();t.Q6J("dataSource",a.items)("trackBy",s.trackById)("matSortDirection",i.direction)("matSortActive",i.sortBy),t.xp6(19),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns)}}function vt(e,n){if(1&e&&(t.TgZ(0,"div")(1,"form",3)(2,"mat-form-field")(3,"mat-label"),t._uU(4,"Search"),t.qZA(),t._UZ(5,"input",4),t.qZA(),t.TgZ(6,"mat-form-field")(7,"mat-label"),t._uU(8,"Filter type"),t.qZA(),t.TgZ(9,"mat-select",5),t.YNc(10,at,2,2,"mat-option",6),t.ALo(11,"keyvalue"),t.qZA()()(),t.YNc(12,ot,2,6,"mat-paginator",7),t.ALo(13,"async"),t.YNc(14,_t,21,6,"table",8),t.ALo(15,"async"),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.Q6J("formGroup",i.filterForms),t.xp6(8),t.Q6J("multiple",!0),t.xp6(1),t.Q6J("ngForOf",t.lcZ(11,5,i.filterOptionsMap.type)),t.xp6(2),t.Q6J("ngIf",t.lcZ(13,7,i.paginationPage$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(15,9,i.sortParams$))}}const h_paginationParams_page=1,h_paginationParams_limit=10,h_sortParams_direction="",h_sortParams_sortBy="";let g=class{constructor(n,i,a,s){this.formBuilder=n,this.router=i,this.route=a,this.monthYearFormat="MMM yyyy",this.animeType=o,this.animeStatus=f,this.isLoading$=new _.X(!0),this.sortedFields=y,this.pageSizeOptions=[5,10,15,20],this.displayedColumns=["image","titleEng","titleJpn","airedStart","type","status"],this.filterOptionsMap={type:{[o.Movie]:o.toReadable(o.Movie),[o.TV]:o.toReadable(o.TV),[o.OVA]:o.toReadable(o.OVA),[o.ONA]:o.toReadable(o.ONA),[o.Special]:o.toReadable(o.Special),[o.Music]:o.toReadable(o.Music),[o.Unknown]:o.toReadable(o.Unknown)}},this.paginationLimit$=new _.X(h_paginationParams_limit),this.paginationPage$=new _.X(h_paginationParams_page),this.sortParams$=new _.X({direction:"",sortBy:""}),this.filterForms=this.formBuilder.nonNullable.group({search:"",type:[]}),this.setInitialParams();const l=this.filterForms.valueChanges.pipe((0,v.b)(()=>this.resetPagination()),(0,E.T)(1),(0,J.O)(this.filterForms.value),(0,Z.U)(({search:c,type:T})=>({search:c??"",type:T??[]})));this.paginatedAnimeList$=(0,w.a)([this.paginationPage$,this.paginationLimit$,this.sortParams$,l]).pipe((0,z.b)(300),(0,v.b)(()=>this.isLoading$.next(!0)),(0,V.w)(([c,T,O,F])=>{const R={page:c,limit:T};return this.updateQueryParams({paginationParams:R,filterParams:F,sortParams:O}),s.getPaginatedAnimeList({paginationParams:R,sortParams:O,filterParams:F}).pipe((0,v.b)(()=>this.isLoading$.next(!1)))}))}handleSortChange(n){this.sortParams$.next({direction:n.direction,sortBy:n.active}),this.resetPagination()}handlePaginationChange(n){this.paginationLimit$.next(n.pageSize),this.paginationPage$.next(n.pageIndex+1)}trackById(n,i){return i.id}resetPagination(){this.paginationPage$.next(1)}updateQueryParams({paginationParams:n,filterParams:i,sortParams:a}){this.router.navigate([],{queryParams:{limit:n.limit,page:n.page,search:i.search??null,sortBy:a.direction?a.sortBy:null,direction:a.direction??null,type:i.type.map(s=>o.toReadable(s))??null},queryParamsHandling:"merge"})}getSortParamsFromQuery(n){return{direction:n.direction??h_sortParams_direction,sortBy:n.sortBy??h_sortParams_sortBy}}getPaginationParamsFromQuery(n){return{limit:n.limit??h_paginationParams_limit,page:n.page??h_paginationParams_page}}getFilterParamsFromQuery(n){const i=n.type,a=[];return"string"==typeof i?a.push(o.fromReadableToAnimeType(i)):i instanceof Array&&i.forEach(s=>a.push(o.fromReadableToAnimeType(s))),{search:n.search??"",type:a}}setInitialParams(){this.route.queryParams.pipe((0,j.P)(),(0,v.b)(n=>{this.setInitialParamsFromQuery(n)}),(0,U.t)(this)).subscribe()}setInitialParamsFromQuery(n){const i=this.getPaginationParamsFromQuery(n);this.paginationPage$.next(i.page),this.paginationLimit$.next(i.limit),this.sortParams$.next(this.getSortParamsFromQuery(n)),this.filterForms.setValue(this.getFilterParamsFromQuery(n))}};g.\u0275fac=function(n){return new(n||g)(t.Y36(d.qu),t.Y36(x.F0),t.Y36(x.gz),t.Y36(K))},g.\u0275cmp=t.Xpm({type:g,selectors:[["camp-anime-table"]],decls:4,vars:6,consts:[["mode","indeterminate",4,"ngIf"],[4,"ngIf"],["mode","indeterminate"],[3,"formGroup"],["matInput","","placeholder","Naruto","formControlName","search"],["formControlName","type",3,"multiple"],[3,"value",4,"ngFor","ngForOf"],["showFirstLastButtons","","aria-label","Pagination panel",3,"length","pageSizeOptions","pageSize","pageIndex","page",4,"ngIf"],["mat-table","","class","table mat-elevation-z8","aria-label","Anime Table","matSort","",3,"dataSource","trackBy","matSortDirection","matSortActive","matSortChange",4,"ngIf"],[3,"value"],["showFirstLastButtons","","aria-label","Pagination panel",3,"length","pageSizeOptions","pageSize","pageIndex","page"],["mat-table","","aria-label","Anime Table","matSort","",1,"table","mat-elevation-z8",3,"dataSource","trackBy","matSortDirection","matSortActive","matSortChange"],["matColumnDef","image"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","titleEng"],["mat-header-cell","",3,"mat-sort-header",4,"matHeaderCellDef"],["matColumnDef","titleJpn"],["matColumnDef","airedStart"],["matColumnDef","type"],["matColumnDef","status"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["alt","",1,"anime-image",3,"src"],["mat-header-cell","",3,"mat-sort-header"],["mat-header-row",""],["mat-row",""]],template:function(n,i){1&n&&(t.YNc(0,it,1,0,"mat-progress-bar",0),t.ALo(1,"async"),t.YNc(2,vt,16,11,"div",1),t.ALo(3,"async")),2&n&&(t.Q6J("ngIf",t.lcZ(1,2,i.isLoading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,i.paginatedAnimeList$)))},dependencies:[u.sg,u.O5,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,M.KE,M.hX,W.gD,q.ey,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,tt.NW,et.pW,L.YE,L.nU,nt.Nt,u.Ov,u.uU,u.Nd],styles:[".table[_ngcontent-%COMP%]{width:100%}.anime-image[_ngcontent-%COMP%]{max-width:150px;max-height:150px}"],changeDetection:0}),g=(0,Q.gn)([(0,U.V)()],g);const bt=[{path:"",title:"Anime list",component:(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["camp-anime-list-page"]],decls:1,vars:0,consts:[[1,"anime-table"]],template:function(i,a){1&i&&t._UZ(0,"camp-anime-table",0)},dependencies:[g],styles:["[_nghost-%COMP%]{display:block}.anime-table[_ngcontent-%COMP%]{padding:0 40px}"],changeDetection:0}),e})()}];let Ct=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.ez,B.m,Y.q,x.Bz.forChild(bt)]}),e})()}}]);